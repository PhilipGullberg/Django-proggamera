{% extends 'profile_layout.html' %}
{% block extrahead%}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        $('#add_class_form').hide()
        $('#add_class').click(function () {
            $('#add_class_form').show()
        });
    });
</script>
<script src="https://unpkg.com/htmx.org@1.1.0"></script>
<script>
    document.body.addEventListener('htmx:configRequest', (event) => {
        event.detail.headers['X-CSRFToken'] = '{{ csrf_token }}';
    })
</script>
{%endblock%}

{% block content %}
<h1>Your classrooms</h1>
<div class="stnd-btn"><a style="text-decoration: none; color:white;" id="add_class">+ Lägg till klass</a> </div>
<div id="add_class_form">
    <form action="" method="POST">
        {% csrf_token %}
        {{ form }}
        <input type="submit" value="Submit">
    </form>
</div>
<div class="classes">
    {% for classroom in classes.all %}
    <div class="class">
        <h3>Klass: {{classroom.name}}</h3>

        <div class="class-content">
            <hr style="border-color:white;">
            <p>Lärare: {{classroom.teacher}} </p>
            <h4>Klassens kurser:</h4>
            {% for course in classroom.courses.all %}

            {{course}}
            <br>
            {%endfor%}
            <br>
            <h4>Elever:</h4>
            {% for student in classroom.students.all %}
            <div >
             {{student}}
            </div>

            
        {%endfor%}
        <br>
        </div>
        <div class="displaymore-btn" id="{{classroom.name}}"><button class="seemore" onclick="readmore(this)">Se mer..</button> </div>
        <hr>
        <div class="class-footer ">
            <div class="stnd-btn" type="button"><a href="{% url 'curr_classroom' classroom.id %}"
                    style="text-decoration: none; color:white;">Go to classroom</a></div>
        </div>
    </div>
    
    {%endfor%}
</div>


{% endblock%}
{% block endscripts %}
<script>
    var div = document.getElementsByClassName('class-content');
    var classroomelement=document.querySelectorAll(".class h3")
    for (let i = 0; i<div.length; i++) {
        var hasVerticalScrollbar = div[i].scrollHeight > div[i].clientHeight;
        
        if (hasVerticalScrollbar){
            let readbtns = document.getElementsByClassName('displaymore-btn');
            let readbtnklass = "Klass: " + readbtns[i].id;
            if(classroomelement[i].innerHTML==readbtnklass){
                readbtns[i].style.display="block";
                div[i].style.overflow="hidden";
            }
            
            
            
            
        }
    }
    
   function readmore(object){
       
       let thing=object.parentNode.parentNode;
       let content = thing.childNodes[3];
       if(String(content.style.maxHeight)==="100%"){
           content.style.maxHeight="300px";
           thing.style.maxHeight="470px";
           object.innerHTML="Se mer.."
       }
       else{
            console.log(content.style.maxHeight);
            thing.style.maxHeight="100%";
            object.innerHTML="Se mindre.."
            content.style.maxHeight="100%";
       }
       
        
    }
    
</script>
<script src="https://unpkg.com/htmx.org@1.1.0"></script>
{%endblock%}